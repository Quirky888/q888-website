---
import Layout from "../layouts/Layout.astro";
import SystemMeta from "../components/SystemMeta.astro";
import SlimNav from "../components/SlimNav.astro";
import LandingHero from "../components/LandingHero.astro";
import ProjectsThreshold from "../components/ProjectsThreshold.astro";
import ProjectDrawer from "../components/ProjectDrawer.astro";
import InfociganSection from "../components/InfociganSection.astro";
import ContactSection from "../components/ContactSection.astro";
---

<Layout title="Q888 â€” Identity">
  <SlimNav />
  <SystemMeta position="top" />
  
  <main class="relative min-h-screen pt-10 md:pt-11">
    <section id="landing" data-section="landing" class="relative">
      <LandingHero />
    </section>

    <section id="projects" data-section="projects">
      <ProjectsThreshold />
    </section>

    <InfociganSection />

    <ContactSection />
  </main>

  <SystemMeta position="bottom" />
  <ProjectDrawer />

  <script>
    import { initThresholdMotion } from "../scripts/thresholdMotion";
    import { initProjectDrawer, destroyProjectDrawer } from "../scripts/drawerNav";
    import { initSystemMetaState, destroySystemMetaState } from "../scripts/systemMetaState";
    import { initNavScroll, destroyNavScroll } from "../scripts/navScroll";
    import { initInfociganPortal, destroyInfociganPortal } from "../scripts/infociganPortal";

    function init() {
      initThresholdMotion();
      initProjectDrawer();
      initSystemMetaState();
      initNavScroll();
      initInfociganPortal();
    }

    function cleanup() {
      destroyProjectDrawer();
      destroySystemMetaState();
      destroyNavScroll();
      destroyInfociganPortal();
    }

    init();

    document.addEventListener("astro:page-load", () => {
      cleanup();
      init();
    });
  </script>
</Layout>
